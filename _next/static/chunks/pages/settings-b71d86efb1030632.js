(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{98510:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return L}});var n=t(59499),i=t(50029),a=t(87794),s=t.n(a),o=t(67294),l=t(57350),c=t(14418),u=t(23100),d=t(38267),f=t(5370),m=t(43655),p=t(8399),h=t(35059),v=t(85893),b=(0,h.G)(function(e,r){let{htmlWidth:t,htmlHeight:n,alt:i,...a}=e;return(0,v.jsx)("img",{width:t,height:n,ref:r,alt:i,...a})});b.displayName="NativeImage";var x=t(15721),j=t(79513),g=(0,h.G)(function(e,r){let{fallbackSrc:t,fallback:n,src:i,srcSet:a,align:s,fit:o,loading:l,ignoreFallback:c,crossOrigin:u,fallbackStrategy:d="beforeLoadOrError",referrerPolicy:f,...m}=e,p=null!=l||c||!(void 0!==t||void 0!==n),h=(0,x.d)({...e,ignoreFallback:p}),g=(0,x.z)(h,d),y={ref:r,objectFit:o,objectPosition:s,...p?m:function(e,r=[]){let t=Object.assign({},e);for(let n of r)n in t&&delete t[n];return t}(m,["onError","onLoad"])};return g?n||(0,v.jsx)(j.m.img,{as:b,className:"chakra-image__placeholder",src:t,...y}):(0,v.jsx)(j.m.img,{as:b,src:i,srcSet:a,crossOrigin:u,loading:l,referrerPolicy:f,className:"chakra-image",...y})});g.displayName="Image";var y=t(29222),_=t(66307),N=t(82580),O=t(93301),k=t.n(O),w=t(14468),P=t(1604),I=t(27420);function E(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function S(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?E(Object(t),!0).forEach(function(r){(0,n.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):E(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var q=P.z.object({file:P.z.custom(),username:P.z.string().max(191)}),F="file-upload",L=function(){(0,_.A)("設定");var e,r,t,n=(0,l.p)(),a=k()(w.x.users.me),h=a.data,b=a.mutate,x=null!=h&&h.icon_path?"".concat("https://fullstack-ts-example-app-prd.s3.ap-northeast-1.amazonaws.com","/").concat(h.icon_path):"",j=(0,o.useState)(x),O=j[0],P=j[1],E=(e=(0,i.Z)(s().mark(function e(r){var t,n,i,a,o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((null===(t=r.target.files)||void 0===t?void 0:t.length)!==0){e.next=3;break}return console.error("File does not exist."),e.abrupt("return");case 3:if(i=null===(n=r.target.files)||void 0===n?void 0:n.item(0)){e.next=7;break}return console.error("The file length is zero and can not be processed."),e.abrupt("return");case 7:return e.next=9,i.arrayBuffer();case 9:return a=e.sent,o=new Blob([new Uint8Array(a)],{type:i.type}),P(URL.createObjectURL(o)),e.abrupt("return",i);case 14:case"end":return e.stop()}},e)})),function(r){return e.apply(this,arguments)}),L=(r=(0,i.Z)(s().mark(function e(r){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.x.users.post({body:{file:r.file,user_name:r.username}});case 2:return e.next=4,b();case 4:n({title:"Account Updated \uD83C\uDF89",description:"Hooray! We've updated your account for you.",status:"success",duration:4e3,isClosable:!0});case 5:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)}),z={file:void 0,username:null!==(t=null==h?void 0:h.user_name)&&void 0!==t?t:""};return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(c.X,{children:"Settings"}),(0,v.jsx)(u.xu,{children:(0,v.jsx)(N.J9,{initialValues:z,onSubmit:L,validationSchema:(0,I.toFormikValidationSchema)(q),children:function(e){var r=e.values,t=e.setFieldValue;return(0,v.jsxs)(N.l0,{children:[(0,v.jsx)(N.gN,{name:"username",children:function(e){var t,n=e.field,i=e.form;return(0,v.jsxs)(d.NI,{as:"fieldset",mb:4,isInvalid:!!i.errors.username,children:[(0,v.jsx)(f.l,{children:"Your Name"}),(0,v.jsx)(m.I,S(S({},n),{},{placeholder:null!==(t=null==h?void 0:h.user_name)&&void 0!==t?t:"John Doe",type:"text",name:"username",value:r.username,required:!0})),(0,v.jsx)(p.J1,{children:i.errors.username})]})}}),(0,v.jsx)(N.gN,{name:"file",children:function(e){var r=e.form;return(0,v.jsxs)(d.NI,{as:"fieldset",mb:4,isInvalid:!!r.errors.file,children:[(0,v.jsx)(f.l,{children:"Your profile picture"}),(0,v.jsx)(g,{cursor:"pointer",src:O,fallbackSrc:"https://via.placeholder.com/150",onClick:function(){var e;return null===(e=document.getElementById(F))||void 0===e?void 0:e.click()}}),(0,v.jsx)(m.I,{id:F,cursor:"pointer",type:"file",placeholder:"Upload your file...",accept:"image/*",onChange:function(e){var r;t("file",null===(r=e.target.files)||void 0===r?void 0:r.item(0)),E(e)}}),(0,v.jsx)(d.Q6,{children:"Recommended square-ish picture. Please make sure upload in valid media types."}),(0,v.jsx)(p.J1,{children:r.errors.file})]})}}),(0,v.jsx)(y.z,{mt:4,colorScheme:"teal",type:"submit",children:"Save"})]})}})})]})}},73406:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings",function(){return t(98510)}])},5370:function(e,r,t){"use strict";t.d(r,{l:function(){return u}});var n=t(38267),i=t(35059),a=t(91639),s=t(33179),o=t(79513),l=t(25432),c=t(85893),u=(0,i.G)(function(e,r){var t;let i=(0,a.mq)("FormLabel",e),u=(0,s.Lr)(e),{className:f,children:m,requiredIndicator:p=(0,c.jsx)(d,{}),optionalIndicator:h=null,...v}=u,b=(0,n.NJ)(),x=null!=(t=null==b?void 0:b.getLabelProps(v,r))?t:{ref:r,...v};return(0,c.jsxs)(o.m.label,{...x,className:(0,l.cx)("chakra-form__label",u.className),__css:{display:"block",textAlign:"start",...i},children:[m,(null==b?void 0:b.isRequired)?p:h]})});u.displayName="FormLabel";var d=(0,i.G)(function(e,r){let t=(0,n.NJ)(),i=(0,n.e)();if(!(null==t?void 0:t.isRequired))return null;let a=(0,l.cx)("chakra-form__required-indicator",e.className);return(0,c.jsx)(o.m.span,{...null==t?void 0:t.getRequiredIndicatorProps(e,r),__css:i.requiredIndicator,className:a})});d.displayName="RequiredIndicator"}},function(e){e.O(0,[745,343,774,888,179],function(){return e(e.s=73406)}),_N_E=e.O()}]);